<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–¢—Ä–µ–∫–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è</title>
  
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  
  <style>
    :root {
      --bg: #f0f4f8;
      --text: #333;
      --card: white;
    }
    [data-theme="dark"] {
      --bg: #0f172a;
      --text: #e2e8f0;
      --card: #1e293b;
    }
    body {
      font-family: system-ui, -apple-system, sans-serif;
      margin: 0;
      padding: 20px 10px;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      text-align: center;
      transition: background 0.3s, color 0.3s;
    }
    h1 {
      font-size: 1.9rem;
      margin: 20px 0 30px;
    }
    .buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 16px;
      max-width: 500px;
      margin: 0 auto 40px;
    }
    button.mood-btn {
      font-size: 1.3rem;
      padding: 16px 20px;
      border: none;
      border-radius: 16px;
      color: white;
      cursor: pointer;
      transition: transform 0.15s ease;
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
    }
    button.mood-btn:active {
      transform: scale(0.92) translateY(2px);
    }
    .happy   { background: #4caf50; }
    .good    { background: #8bc34a; }
    .neutral { background: #ff9800; }
    .tired   { background: #9e9e9e; }
    .sad     { background: #f44336; }
    .angry   { background: #d32f2f; }
    .sleepy  { background: #673ab7; }
    h2 { font-size: 1.5rem; margin: 30px 0 15px; }
    .stats p { font-size: 1.25rem; margin: 10px 0; }
    .share-btn, .reset-btn {
      margin: 20px 10px;
      padding: 14px 40px;
      font-size: 1.2rem;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      color: white;
    }
    .share-btn { background: #3b82f6; }
    .reset-btn { background: #607d8b; }
    .share-btn:hover, .reset-btn:hover { opacity: 0.9; }
  </style>
</head>
<body>

  <h1>–ö–∞–∫–æ–µ —É —Ç–µ–±—è —Å–µ–π—á–∞—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ?</h1>

  <div class="buttons">
    <button class="mood-btn happy"   onclick="addMood('happy')">üòÑ –†–∞–¥–æ—Å—Ç–Ω—ã–π</button>
    <button class="mood-btn good"    onclick="addMood('good')">üòä –•–æ—Ä–æ—à–æ</button>
    <button class="mood-btn neutral" onclick="addMood('neutral')">üòê –ù–æ—Ä–º–∞–ª—å–Ω–æ</button>
    <button class="mood-btn tired"   onclick="addMood('tired')">üòï –£—Å—Ç–∞–ª</button>
    <button class="mood-btn sad"     onclick="addMood('sad')">üòî –ì—Ä—É—Å—Ç–Ω–æ</button>
    <button class="mood-btn angry"   onclick="addMood('angry')">üò† –ó–ª—é—Å—å</button>
    <button class="mood-btn sleepy"  onclick="addMood('sleepy')">üò¥ –°–æ–Ω–Ω—ã–π</button>
  </div>

  <h2>–°–µ–≥–æ–¥–Ω—è:</h2>
  <div class="stats">
    <p>üòÑ –†–∞–¥–æ—Å—Ç–Ω—ã–π: <span id="happy">0</span></p>
    <p>üòä –•–æ—Ä–æ—à–æ:    <span id="good">0</span></p>
    <p>üòê –ù–æ—Ä–º–∞–ª—å–Ω–æ: <span id="neutral">0</span></p>
    <p>üòï –£—Å—Ç–∞–ª:     <span id="tired">0</span></p>
    <p>üòî –ì—Ä—É—Å—Ç–Ω–æ:   <span id="sad">0</span></p>
    <p>üò† –ó–ª—é—Å—å:     <span id="angry">0</span></p>
    <p>üò¥ –°–æ–Ω–Ω—ã–π:    <span id="sleepy">0</span></p>
  </div>

  <button class="share-btn" onclick="shareStats()">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π</button>
  <button class="reset-btn" onclick="resetStats()">–°–±—Ä–æ—Å–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>

  <script>
    // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏–∑ localStorage
    let moods = JSON.parse(localStorage.getItem('moodStats')) || {
      happy: 0, good: 0, neutral: 0, tired: 0, sad: 0, angry: 0, sleepy: 0
    };

    const messages = {
      happy:   "–ö—Ä—É—Ç–æ! –ü—Ä–æ–¥–æ–ª–∂–∞–π –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ üòÑ‚ú®",
      good:    "–û—Ç–ª–∏—á–Ω–æ, –¥–µ—Ä–∂–∏ –ø–æ–∑–∏—Ç–∏–≤! üòä",
      neutral: "–í—Å—ë —Ä–æ–≤–Ω–æ ‚Äî —É–∂–µ —Ö–æ—Ä–æ—à–æ üëç",
      tired:   "–û—Ç–¥–æ—Ö–Ω–∏ —Å–∫–æ—Ä–µ–µ, —Ç—ã –º–æ–ª–æ–¥–µ—Ü üåô",
      sad:     "–û–±–Ω–∏–º–∞—é –∫—Ä–µ–ø–∫–æ ü§ó –í—Å—ë –Ω–∞–ª–∞–¥–∏—Ç—Å—è",
      angry:   "–í—ã–¥–æ—Ö–Ω–∏, —ç—Ç–æ –ø—Ä–æ–π–¥—ë—Ç üí®",
      sleepy:  "–ü–æ—Ä–∞ –≤ –∫—Ä–æ–≤–∞—Ç–∫—É, —Å–ª–∞–¥–∫–∏—Ö —Å–Ω–æ–≤ üò¥"
    };

    function updateDisplay() {
      Object.keys(moods).forEach(key => {
        const el = document.getElementById(key);
        if (el) el.textContent = moods[key];
      });
    }

    function addMood(type) {
      moods[type]++;
      updateDisplay();
      localStorage.setItem('moodStats', JSON.stringify(moods));

      if (window.Telegram?.WebApp) {
        Telegram.WebApp.showPopup({
          title: "–ó–∞–ø–∏—Å–∞–Ω–æ!",
          message: messages[type],
          buttons: [{ type: "ok" }]
        });
      }
    }

    function resetStats() {
      if (confirm("–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ —Å—á—ë—Ç—á–∏–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è?")) {
        Object.keys(moods).forEach(key => moods[key] = 0);
        updateDisplay();
        localStorage.removeItem('moodStats');
      }
    }

    function shareStats() {
      if (!window.Telegram?.WebApp) {
        alert("–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ Telegram");
        return;
      }

      let text = "–ú–æ—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å–µ–≥–æ–¥–Ω—è:\n";
      Object.keys(moods).forEach(key => {
        if (moods[key] > 0) {
          const emoji = {happy:"üòÑ", good:"üòä", neutral:"üòê", tired:"üòï", sad:"üòî", angry:"üò†", sleepy:"üò¥"}[key];
          text += `${emoji} ${key.charAt(0).toUpperCase() + key.slice(1)}: ${moods[key]}\n`;
        }
      });
      if (text === "–ú–æ—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å–µ–≥–æ–¥–Ω—è:\n") text += "–ü–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ –∑–∞–ø–∏—Å–∞–Ω–æ üòÖ";

      const shareText = encodeURIComponent(text);
      const shareUrl = encodeURIComponent(window.location.href);

      // –ù–∞–¥—ë–∂–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ Telegram-—Å—Å—ã–ª–∫—É
      Telegram.WebApp.openTelegramLink(`https://t.me/share/url?url=${shareUrl}&text=${shareText}`);
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    updateDisplay();

    if (window.Telegram?.WebApp) {
      const tg = Telegram.WebApp;
      tg.ready();
      tg.expand();

      // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Ç–µ–º—É Telegram
      const theme = tg.themeParams;
      document.documentElement.style.setProperty('--bg', theme.bg_color || '#f0f4f8');
      document.documentElement.style.setProperty('--text', theme.text_color || '#333');
      document.documentElement.style.setProperty('--card', theme.secondary_bg_color || 'white');

      // –¶–≤–µ—Ç —Ö–µ–¥–µ—Ä–∞ –∏ —Ñ–æ–Ω–∞
      tg.setHeaderColor('bg_color');
      tg.setBackgroundColor(theme.bg_color);
    }
  </script>
</body>
</html>
